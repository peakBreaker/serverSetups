---
# tasks for webservers to run git clone on repo and run application
#- name: Apt | Update
#  apt:
#    update-cache: yes
- name: set_fact | Set SSH port to {{ ssh_port }}
  set_fact:
    ansible_port: "{{ ssh_port }}"

- name: Synchronize | Application directory
  synchronize:
    src: app/{{ wsgi_application }}
    dest: /var/www/html/

# Then we enable the virtualenv and install the dependencies for python

# Next we copy over the configurations

- name: Synchronize | Apache configurations
  synchronize:
    src: app/serverSetups/config/apache/000-default.conf
    dest: /etc/apache2/sites-enabled/000-default.conf

- name: Synchronize | WSGI configurations
  synchronize:
    src: app/serverSetups/config/wsgi/myapp.wsgi
    dest: /var/www/html/
  notify: restart apache2
